name: Pull request checks

on:
  push:
    branches:
      - main
      - develop

  pull_request:
    types:
      - opened
      - synchronize
      - reopened

jobs:

  python-quality-check: # Install dependencies and run tests with pytest
     name: Python tests
     runs-on: ubuntu-latest

     strategy:
       matrix:
         python-version: ["3.11","3.12"]

     steps:
       - uses: actions/checkout@v3
       - name: Set up Python ${{ matrix.python-version }}
         uses: actions/setup-python@v4
         with:
           python-version: ${{ matrix.python-version }}
       - name: Install dependencies
         run: |
           python -m pip install --upgrade pip
           pip install .
           pip install -r scripts/quality_requirements.txt
       - name: Launch quality check
         run: |
            cd scripts 
            chmod +x run_quality_check.sh
            ./run_quality_check.sh
            cd ..
       - name: Launch test coverage
         run: |
            cd scripts 
            chmod +x run_test_coverage.sh
            ./run_test_coverage.sh
            cd ..
